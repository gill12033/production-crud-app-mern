$(function()
{$(document).ready(function(){setTimeOfDayBgImage();$('[data-toggle="popover"]').popover();$(".pop").popover({trigger:"manual",html:true,animation:false}).on("mouseenter",function(){var _this=this;$(this).popover("show");$(".popover").on("mouseleave",function(){$(_this).popover('hide');});}).on("mouseleave",function(){var _this=this;setTimeout(function(){if(!$(".popover:hover").length){$(_this).popover("hide");}},300);});$(document).ready(function(){var elem=document.getElementById('messages-list');elem.scrollTop=elem.scrollHeight;});$('[data-toggle="tooltip"]').tooltip();$('input[name="account_type"]').change(function(){var isBusinessAccount=$('input:checked[name="account_type"]').val()=="business";$('.business_input').toggleClass("hide");});$('.lightbox').lightbox();$('.dropdown-menu input').click(function(){return false;}).change(function(){$(this).parent('.dropdown-menu').siblings('.dropdown-toggle').dropdown('toggle');}).keydown('esc',function(){this.value='';$(this).change();});$('input[name="service"]').change(function(){var isPaypal=$('input:checked[name="service"]').val()=="paypal";$('#paypal_options').toggleClass("hide");$('#swift_options').toggleClass("hide");});$(document).on("click",'#notification-dropdown',function(event){getNotifications();return false;});$(document).on("click",'.like-button',function(event){var itemId=$(this).data("item");var returnFormat=$(this).data("returnformat");likeItem(itemId,returnFormat);return false;});$(document).on("click",'.bookmark-button',function(event){var itemId=$(this).data("item");var collectionId=$(this).data("collection");bookmarkItem(itemId,collectionId);return false;});$(document).on('submit','#addCollectionForm',function(e){e.preventDefault();var addCollectionName=$("#addCollectionName").val();var addCollectionPublic=$('#addCollectionPublic').is(":checked");var addCollctionItemId=$("#addCollectionItemId").val();if(addCollectionName.length<=2){console.log(addCollectionName.length);$('#addCollectionNameGroup').addClass("has-error");}else if(addCollectionName.length>2){$('#addCollectionNameGroup').removeClass("has-error");$('#addCollectionName').val("");$('#addCollectionPublic').attr('checked',false);addCollection(addCollectionName,addCollectionPublic,addCollctionItemId);}
return false;});$('body').on('hidden.bs.modal','.modal',function(){$(this).removeData('bs.modal');});$(document).on('submit','#addMessageForm',function(e){e.preventDefault();var addMessageText=$("#addMessageText").val();var addMessageRecipientId=$("#addMessageRecipientId").val();if(addMessageText.length<=0){console.log(addMessageText.length);$('#addMessageText').addClass("has-error");}else if(addMessageText.length>0){$('#addMessageText').removeClass("has-error");$('#addMessageText').val("");addMessage(addMessageText,addMessageRecipientId);}
return false;});$(document).on("click",'#cookie-agree-button',function(event){cookieAgree();return false;});});});function getNotifications(){$.ajax({type:'POST',url:'/notifications//ajax/',data:{action:'list'},beforeSend:function(){},success:function(data){$('#headerbar-notifications').html(data);},error:function(){}});}
function likeItem(itemId,returnFormat){$.ajax({type:'POST',url:'/items/ajax/',data:{action:'like',itemId:itemId,returnFormat:returnFormat},beforeSend:function(){},success:function(data){$('#like-button-holder-'+itemId).html(data);},error:function(){}});}
function bookmarkItem(itemId,collectionId){$.ajax({type:'POST',url:'/collections/ajax/',data:{action:'bookmark',itemId:itemId,collectionId:collectionId},beforeSend:function(){},success:function(data){$('#collection-status-'+collectionId).html(data);},error:function(){}});}
function addCollection(addCollectionName,addCollectionPublic,addCollectionItemId){$.ajax({type:'POST',url:'/collections/ajax/',data:{action:'addCollection',name:addCollectionName,publically_visible:addCollectionPublic,itemId:addCollectionItemId},beforeSend:function(){},success:function(data){$('#collectionList').prepend(data);},error:function(){}});}
function addMessage(addMessageText,addMessageRecipientId){$.ajax({type:'POST',url:'/messages/ajax/',data:{action:'addMessage',messageText:addMessageText,recipientId:addMessageRecipientId},beforeSend:function(){},success:function(data){$('#messages-list-container').append(data);var elem=document.getElementById('messages-list');elem.scrollTop=elem.scrollHeight;},error:function(){}});}
function cookieAgree(){$.ajax({type:'POST',url:'/users/ajax/',data:{action:'cookieAgree'},beforeSend:function(){},success:function(data){$('#cookieModal').modal('toggle');},error:function(){}});}
function setTimeOfDayBgImage(){var d=new Date();var n=d.getHours();if(n<6){$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-night.jpg')");}
else if(n>5&&n<10){$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-sunrise.jpg')");}
else if(n>9&&n<12){$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-morning.jpg')");}
else if(n>11&&n<15){$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-noon.jpg')");}
else if(n>14&&n<18){$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-afternoon.jpg')");}
else{$(".frontpage-header").css("background","url('/static/img/backgrounds/frontpage-bg-sunset.jpg')");}
$(".frontpage-header").css("background-size","cover");$(".frontpage-header").css("background-repeat","no-repeat");$(".frontpage-header").css("background-position","50% 50%");$(".frontpage-header").css("position","relative");}